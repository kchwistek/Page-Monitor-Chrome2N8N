<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Page Monitor to n8n</title>
  <link rel="stylesheet" href="popup.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
</head>
<body>
  <div class="popup-container">
    <div class="header">
      <div class="branding">
        <i class="fas fa-eye"></i>
        <span class="app-name">Page Monitor</span>
      </div>
      <div class="header-actions">
        <a class="settings-icon" href="#" title="Settings" id="settingsIcon">
          <i class="fas fa-cog"></i>
        </a>
      </div>
      <div class="subtitle">Monitor pages and send to n8n</div>
    </div>

    <!-- Monitoring Section -->
    <div class="monitoring-section">
      <!-- Tab Selection -->
      <div class="form-group compact">
        <label for="tabSelector">
          <i class="fas fa-window-maximize"></i>
          Tab
        </label>
        <select id="tabSelector" class="compact-input">
          <option value="">Loading tabs...</option>
        </select>
      </div>

      <!-- CSS Selector -->
      <div class="form-group compact">
        <label for="selector">
          <i class="fas fa-code"></i>
          CSS Selector
        </label>
        <input 
          type="text" 
          id="selector" 
          class="compact-input"
          placeholder="e.g., #content, .main-content"
        />
      </div>

      <!-- Settings Row -->
      <div class="settings-row">
        <div class="form-group compact">
          <label for="refreshInterval">
            <i class="fas fa-clock"></i>
            Interval (s)
          </label>
          <input 
            type="number" 
            id="refreshInterval" 
            class="compact-input"
            min="5" 
            value="30"
            style="width: 60px;"
          />
        </div>
        <div class="form-group compact">
          <label for="contentType">
            <i class="fas fa-file-code"></i>
            Type
          </label>
          <select id="contentType" class="compact-input" style="width: 80px;">
            <option value="html">HTML</option>
            <option value="text">Text</option>
          </select>
        </div>
      </div>

      <!-- Webhook URL -->
      <div class="form-group compact">
        <label for="webhookUrl">
          <i class="fas fa-link"></i>
          Webhook URL
        </label>
        <input 
          type="text" 
          id="webhookUrl" 
          class="compact-input"
          placeholder="https://your-n8n-instance.com/webhook/..."
        />
        <small style="font-size: 10px; color: #666; margin-top: 4px; display: block;">
          Leave empty to use global webhook from settings
        </small>
      </div>

      <!-- Checkbox -->
      <div class="form-group compact checkbox-group">
        <label>
          <input type="checkbox" id="changeDetection" checked />
          <span>Only send when content changes</span>
        </label>
      </div>

      <!-- Profile Management -->
      <div class="form-group compact">
        <label>
          <i class="fas fa-bookmark"></i>
          Profile
        </label>
        <div class="profile-row">
          <select id="profileSelector" class="compact-input" style="flex: 1;">
            <option value="">-- Select --</option>
          </select>
          <button type="button" id="loadProfileBtn" class="btn-icon" title="Load">
            <i class="fas fa-download"></i>
          </button>
          <button type="button" id="saveProfileBtn" class="btn-icon" title="Save to selected profile">
            <i class="fas fa-save"></i>
          </button>
          <button type="button" id="saveAsProfileBtn" class="btn-icon" title="Save as new profile">
            <i class="fas fa-file-plus"></i>
          </button>
        </div>
        <div class="profile-input-row" id="saveProfileGroup" style="display: none;">
          <input 
            type="text" 
            id="profileNameInput" 
            class="compact-input"
            placeholder="Profile name..."
            style="flex: 1;"
          />
          <button type="button" id="confirmSaveBtn" class="btn-icon btn-success" title="Confirm">
            <i class="fas fa-check"></i>
          </button>
          <button type="button" id="cancelSaveBtn" class="btn-icon" title="Cancel">
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>

      <!-- Status Display -->
      <div class="status-display" id="statusDisplay" style="display: none;">
        <div class="status-indicator">
          <i class="fas fa-circle status-dot" id="statusDot"></i>
          <span id="statusText">Monitoring active</span>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="startBtn" class="btn btn-primary btn-compact">
          <i class="fas fa-play"></i>
          Start
        </button>
        <button id="stopBtn" class="btn btn-secondary btn-compact" disabled>
          <i class="fas fa-stop"></i>
          Stop
        </button>
        <button id="testBtn" class="btn btn-test btn-compact">
          <i class="fas fa-vial"></i>
          Test
        </button>
        <button id="sendNowBtn" class="btn btn-send btn-compact">
          <i class="fas fa-paper-plane"></i>
          Send
        </button>
      </div>

      <!-- Result Message -->
      <div id="resultMessage" class="result-message" style="display: none;"></div>

      <!-- Activity Log Section -->
      <div class="activity-log-section" id="activityLogSection">
        <div class="activity-log-header">
          <div class="activity-log-title">
            <i class="fas fa-list-alt"></i>
            <span>Activity Log</span>
          </div>
          <div class="activity-log-controls">
            <select id="logFilter" class="compact-input" style="width: 120px; font-size: 11px;">
              <option value="all">All</option>
              <option value="errors">Errors Only</option>
              <option value="warnings">Warnings</option>
              <option value="monitoring">Monitoring</option>
              <option value="extraction">Extraction</option>
              <option value="webhook">Webhook</option>
            </select>
            <button id="clearLogBtn" class="btn-icon" title="Clear Log" style="padding: 4px 8px;">
              <i class="fas fa-trash"></i>
            </button>
            <button id="refreshLogBtn" class="btn-icon" title="Refresh" style="padding: 4px 8px;">
              <i class="fas fa-sync-alt"></i>
            </button>
          </div>
        </div>
        <div class="activity-log-entries" id="activityLogEntries">
          <div class="activity-log-empty">No activity yet</div>
        </div>
      </div>
    </div>

    <div class="footer">
      Made with ❤️ for better n8n workflows by Karel Chwistek
    </div>
  </div>
  <script src="popup.js"></script>
</body>
</html>

